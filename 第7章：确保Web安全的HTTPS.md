                    ### 1. HTTP 的缺点

* 通信使用明文（不加密），内容可能会被窃听。
* 不验证通信双方的身份，因此有可能遭遇伪装。
* 无法证明报文的完整性，所以有可能已遭篡改。



#### 1.1 通信使用明文可能会被窃听

* TCP/IP 是可能被窃听的网络
* 加密处理防止被窃听
  * 通信的加密
  * 内容的加密



#### 1.2 不验证通信方的身份就可能遭遇伪装

* 任何人都可发起请求
* 查明对手的证书

​	证书由值得信任的第三方机构颁发，用以证明服务器和客户端是实际存在的。另外，伪造证书从技术角度来说是异常困难的一件事。所以，只要能够确认通信方（服务器或客户端）持有的证书，即可判断通信方的真实意图。



#### 1.3 无法证明报文完整性，可能已遭篡改

* 接收到的内容可能有误

​	中间人攻击：请求或响应在传输途中，遭攻击者拦截并篡改内容的攻击。

* 如何防止篡改



### 2. HTTP + 加密 + 认证 + 完整性保护 = HTTPS

#### 2.2 HTTPS 是身披 SSL 外壳的 HTTP

通常，HTTP 直接和 TCP 通信。当使用 SSL 时，则演变成先和 SSL 通信，再由 SSL 和 TCP 通信了。简言之，所谓 HTTPS，其实就是身披 SSL 协议这层外壳的 HTTP。

在采用 SSL 后，HTTP 就拥有了 HTTPS 的加密、证书和完整性保护这些功能。

SSL 是独立于 HTTP 的协议，所以不光是 HTTP 协议，其他运行在应用层的 SMTP 和 Telnet 等协议均可配合 SSL 协议使用。可以说 SSL 是当今世界上应用最为广泛的网络安全技术。

![](https://github.com/WqhForGitHub/TCP-IP-HTTP/blob/%E5%9B%BE%E8%A7%A3HTTP/static/Chapter7/HTTPS.png?raw=true)



#### 2.3 相互交换密钥的公开密钥加密技术

* 共享密钥加密的困境

​	加密和解密同用一个密钥的方式称为共享密钥加密，也被叫做对称密钥加密。以共享密钥方式加密时必须将密钥也发给对方。可究竟怎样才能安全地转交？在互联网上转发密钥时，如果通信被监听那么密钥就可会落入攻击者之手，同时也就是失去了加密的意义。另外还得设法安全地保管接收到地密钥。

* 使用两把密钥的公开密钥加密

  公开密钥加密方式很好地解决了共享密钥加密的困难。

  公开密钥加密使用一对非对称的密钥。一把叫做私有密钥，另一把叫做公开密钥。顾名思义，私有密钥不能让其他任何人知道，而公开密钥则可以随意发布，任何人都可以获得。

  使用公开密钥加密方式，发送密文的一方使用对方的公开密钥进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。利用这种方式，不需要发送用来解密的私有密钥，也不必担心密钥被攻击者窃听而盗走。 

* HTTPS 采用混合加密机制

1. 使用公开密钥加密方式安全地交换在稍后的共享密钥加密中要使用的密钥
2. 确保交换的密钥是安全的前提下，使用共享密钥加密方式进行通信。   



#### 2.4 证明公开密钥正确性的证书

1.  服务器把自己的公开密钥登录至数字证书认证机构
2. 数字证书认证机构用自己的私有密钥向服务器的公开密码部署数字签名并颁发公钥证书。
3. 客户端拿到服务器的公钥证书后，使用数字证书认证机构的公开密钥，向数字证书认证机构验证公钥证书上的数字签名，以确认服务器的公开密钥的真实性。
4. 使用服务器的公开密钥对报文加密后发送
5. 服务器用私有密钥对报文解密











